<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="renderer" content="webkit|ie-comp|ie-stand">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<!--[if lt IE 9]>
    <script type="text/javascript" src="lib/html5shiv.js"></script>
    <script type="text/javascript" src="lib/respond.min.js"></script>
    <![endif]-->
		<link rel="stylesheet" type="text/css" href="static/h-ui/css/H-ui.min.css" />
		<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/H-ui.admin.css" />
		<link rel="stylesheet" type="text/css" href="lib/Hui-iconfont/1.0.8/iconfont.css" />
		<link rel="stylesheet" type="text/css" href="static/h-ui.admin/skin/default/skin.css" id="skin" />
		<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/style.css" />
		<!--[if IE 6]>
    <script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
    <script>DD_belatedPNG.fix('*');</script>
    <![endif]-->

		<title>区委公文</title>
	</head>

	<body>

		<nav class="breadcrumb">
			<i class="Hui-iconfont">&#xe671;</i> 区委公文 -> 主页
			<a class="btn btn-primary radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新"><i class="Hui-iconfont">&#xe68f;</i></a>
		</nav>
		<div class="page-container">

			<div class="cl bg-1 bk-gray">
				<span class="l">
                <!--<a href="javascript:;" onclick="article_del()" class="btn btn-danger radius"><i class="Hui-iconfont">&#xe6e2;</i> 批量删除</a>-->
                <a class="btn btn-primary radius" data-title="新建区委公文" onclick="article_add('新建区委公文', 'article-add.html')" href="javascript:;">
                    <i class="Hui-iconfont">&#xe600;</i> 新建
                </a>
                <a href="javascript:;" onclick="article_update('2')" class="btn btn-primary radius"><i class="Hui-iconfont">&#xe6de;</i> 公文督查项设置 <span class="badge badge-danger radius">12</span></a>
				<a href="javascript:;" onclick="article_update('2')" class="btn btn-primary radius"><i class="Hui-iconfont">&#xe6de;</i> 公文周上报 <span class="badge badge-danger radius">12</span></a>
				<a href="javascript:;" onclick="article_update('2')" class="btn btn-primary radius"><i class="Hui-iconfont">&#xe6de;</i> 公文月上报 <span class="badge badge-danger radius">12</span></a>
				<a class="btn btn-primary radius" data-title="查询" onclick="article_add('查询', 'article-add.html')" href="javascript:;">
					<i class="Hui-iconfont">&#xe600;</i> 查询
				</a>
				</span>
				<span class="r"></span>
			</div>

			<div class="mt-20">
				<table id="mytabledtlist" class="table table-border table-bordered table-bg table-hover table-sort">
					<thead>
						<tr>
							<th lay-data="{fixed:'left',sort: true}" rowspan="2">编号</th>
							<th lay-data="{field:'username'}" rowspan="2">会议主题</th>
							<th lay-data="{field:'username',sort: true}" rowspan="2">会议时间</th>
							<th lay-data="{field:'username'}" rowspan="2">督查负责人</th>
							<th lay-data="{align:'center'}" colspan="2">无故缺席</th>
							<th lay-data="{align:'center'}" colspan="2">迟到早退</th>
							<th lay-data="{align:'center'}" colspan="2">玩手机、打瞌睡、未按要求着装</th>
							<th lay-data="{align:'center'}" colspan="2">交头接耳</th>
							<th lay-data="{align:'center'}" colspan="2">发言超时</th>
							<th lay-data="{fixed: 'right' ,align: 'center', toolbar: '#barDemo'}" rowspan="2">操作</th>
						</tr>
						<tr>
							<th lay-data="{field:'province'}">部门</th>
							<th lay-data="{field:'city',sort: true}">人次</th>
							<th lay-data="{field:'province'}">部门</th>
							<th lay-data="{field:'city',sort: true}">人次</th>
							<th lay-data="{field:'province'}">部门</th>
							<th lay-data="{field:'city',sort: true}">人次</th>
							<th lay-data="{field:'province'}">部门</th>
							<th lay-data="{field:'city',sort: true}">人次</th>
							<th lay-data="{field:'province'}">部门</th>
							<th lay-data="{field:'city',sort: true}">人次</th>

						</tr>
					</thead>

				</table>
			</div>
		</div>

		<!--_footer 作为公共模版分离出去-->
		<script type="text/javascript" src="lib/jquery/1.9.1/jquery.min.js"></script>
		<script type="text/javascript" src="lib/layer/2.4/layer.js"></script>
		<script type="text/javascript" src="static/h-ui/js/H-ui.min.js"></script>
		<script type="text/javascript" src="static/h-ui.admin/js/H-ui.admin.js"></script>
		<!--/_footer 作为公共模版分离出去-->
		<!--请在下方写此页面业务相关的脚本-->
		<script type="text/javascript" src="lib/My97DatePicker/4.8/WdatePicker.js"></script>
		<script type="text/javascript" src="lib/datatables/1.10.15/jquery.dataTables.min.js"></script>
		<script type="text/javascript" src="lib/laypage/1.2/laypage.js"></script>

		<!--按钮功能入口-->
		<script type="text/javascript">
			/*文章-添加*/
			function article_add(title, url, w, h) {
				var index = layer.open({
					type: 2,
					title: title,
					content: url
				});
				layer.full(index);
			}
			/*文章-编辑*/
			function article_edit(title, url, id, w, h) {
				url += "?aid=" + id;

				var index = layer.open({
					type: 2,
					title: title,
					content: url
				});
				layer.full(index);
			}

			/*文章-更新*/
			function article_update(stt) {

				var n_length = $("#mytabledtlist tbody tr td input[type='checkbox']:checked").length;
				if(n_length <= 0) {
					layer.msg('请选择操作项！', {
						icon: 0
					}); //0-警告；1-成功；2-失败
					return;
				}

				var ss_show = '';
				if(stt == '1') {
					ss_show = '确认要批量启用吗？';
				}
				if(stt == '2') {
					ss_show = '确认要批量停用吗？';
				}

				layer.confirm('' + ss_show + '', function(index) {

					var strdel_aids = '|';
					$("#mytabledtlist tbody tr td input[type='checkbox']:checked").each(function(index, item) {
						strdel_aids += $(item).attr("value") + '|';
					});

					//alert(strdel_aids);
					//return false;
					$.ajax({
						type: 'POST',
						url: '../include/articleupdate.php',
						dataType: 'html',
						data: "stt=" + stt + "&prmids=" + strdel_aids,
						success: function(data) {
							//$(obj).parents("tr").remove();
							layer.msg('操作成功！', {
								icon: 5,
								time: 1000
							});
							fn_search();
						},
						error: function(data) {
							layer.msg('操作失败！', {
								icon: 6,
								time: 1000
							});
						},
					});
				}, function() {
					layer.msg('操作失败', {
						icon: 6,
						time: 1000
					});
				});
			}

			/*文章-删除*/
			function article_del() {
				layer.confirm('确认要删除吗？', function(index) {

					var strdel_aids = '';
					$("#mytabledtlist tbody tr td input[type='checkbox']:checked").each(function(index, item) {
						strdel_aids += ',' + $(item).attr("value");
					});

					//alert(strdel_aids);
					//return false;
					//$.ajax({
					//	type: 'POST',
					//	url: '',
					//	dataType: 'json',
					//	success: function(data){
					//		//$(obj).parents("tr").remove();
					//		layer.msg('已删除!',{icon:1,time:1000});
					//	},
					//	error:function(data) {
					//		console.log(data.msg);
					//	},
					//});
					layer.msg('未通过', {
						icon: 5,
						time: 1000
					});
				}, function() {
					layer.msg('已启用', {
						icon: 6,
						time: 1000
					});
				});
			}

			/*文章-发布*/
			function article_publish() {

				var s_cx_articlecolumn = $("#cx_articlecolumn").val();
				if(s_cx_articlecolumn == "0") {
					layer.msg('请选择发布数据栏目！', {
						icon: 6,
						time: 1000
					});
					return;
				}

				layer.confirm('是否要发布最新数据？', function(index) {
					$.ajax({
						type: 'POST',
						url: '../include/articlecreatejs.php',
						dataType: 'html',
						data: "articlecolumn=" + s_cx_articlecolumn,
						success: function(rdata) {
							//alert(rdata);
							layer.msg('发布最新数据成功！', {
								icon: 1
							}); //0-警告；1-成功；2-失败
						},
						error: function(data) {
							//alert("err");
							//console.log(data);
						}
					});
				}, function() {
					//layer.msg('操作失败', { icon: 6, time: 1000 });
				});
			}
		</script>

		<!--初始入口-->
		<script>
			//var table = $('.table-sort').dataTable({
			//    "scrollY": "200px",
			//    "paging": false
			//});

			function fn_inittablegrid(dataString) {

				$("#mytbody").empty();

				var index_ts = layer.open({
					type: 3,
					content: "<p>正在获取数据...</p>"
				});

				$.ajax({
					type: 'POST',
					cache: false,
					url: '../include/articleselect.php',
					dataType: 'html',
					data: dataString,
					success: function(rdata) {
						//alert(rdata);
						//return;
						var obj = eval('(' + rdata + ')');
						//console.log(obj.length);
						//for (var n = 0; n < obj.length; n++) {
						//    var aid = obj[n].aid;
						//    var articletitle = obj[n].articletitle;
						//    var articletitle2 = obj[n].articletitle2;
						//    var articlecolumn = obj[n].articlecolumn;
						//    var articletype = obj[n].articletype;
						//    var articlesort = obj[n].articlesort;
						//    var author = obj[n].author;
						//    var sources = obj[n].sources;
						//    var astatus = obj[n].astatus;

						//    //console.log(aid);
						//    var ss = '<tr class="text-c">';
						//    ss += '<td><input type="checkbox" value="" name=""></td>';
						//    ss += '<td>' + aid + '</td>';
						//    ss += '<td class="text-l"><u style="cursor:pointer" class="text-primary" onClick="article_edit(\'查看\',\'article-zhang.html\',\'10001\')" title="查看">' + articletitle + '</u></td>';
						//    ss += '<td>' + articlecolumn + '</td>';
						//    ss += '<td>' + articletype + '</td>';
						//    ss += '<td>' + author + '</td>';
						//    ss += '<td>' + sources + '</td>';
						//    ss += '<td class="td-status"><span class="label label-success radius">' + astatus + '</span></td>';
						//    ss += '<td class="f-14 td-manage"><a style="text-decoration:none" onClick="article_stop(this,\'10001\')" href="javascript:;" title="停用"><i class="Hui-iconfont">&#xe6de;</i></a> <a style="text-decoration:none" class="ml-5" onClick="article_edit(\'资讯编辑\',\'article-add.html\',\'10001\')" href="javascript:;" title="编辑"><i class="Hui-iconfont">&#xe6df;</i></a> <a style="text-decoration:none" class="ml-5" onClick="article_del(this,\'10001\')" href="javascript:;" title="删除"><i class="Hui-iconfont">&#xe6e2;</i></a></td>';
						//    ss += '</tr>';
						//    $(ss).appendTo($("#mytbody"));
						//}

						fn_init_dataTable();

						layer.close(index_ts);
					},
					error: function(data) {
						layer.close(index_ts);
					}
				});
			}

			function fn_init_dataTable() {
				$('#mytabledtlist').dataTable();
			}

			function fn_excpubfn() {
				//alert("刷新数据");
				fn_search();
			}

			function fn_search() {
				//alert("begin");
				var s_cx_articlecolumn = $("#cx_articlecolumn").val();
				var s_cx_aupdttmin = $("#cx_aupdttmin").val();
				var s_cx_aupdttmax = $("#cx_aupdttmax").val();
				var s_cx_articletitle = $("#cx_articletitle").val();

				//alert(s_cx_articlecolumn);

				var strwhere = "action=1";
				if(s_cx_articlecolumn != "0") {
					strwhere += "&articlecolumn=" + s_cx_articlecolumn;
				}
				if(s_cx_articletitle != "") {
					strwhere += "&articletitle=" + s_cx_articletitle;
				}

				//alert(strwhere);
				//return;
				fn_inittablegrid(strwhere);
			}

			function fn_selectallchecked(obj) {
				//alert("ddd");
				//alert($(obj).prop("checked"));
				var ostatus = $(obj).prop("checked");

				$("#mytabledtlist tbody tr td input[type='checkbox']").prop("checked", ostatus);

				//console.log($("#mytabledtlist").html());

			}

			$(function() {
				//$(".Hui-aside").click();
				fn_init_dataTable()
				//fn_inittablegrid("");
			});
		</script>
	</body>

</html>